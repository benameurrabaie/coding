<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TP1 - Apprendre C++</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
<style>
:root {
  --primary: #6366f1;
  --primary-dark: #4f46e5;
  --primary-light: #818cf8;
  --secondary: #06b6d4;
  --accent: #f59e0b;
  --success: #10b981;
  --error: #ef4444;
  --warning: #f59e0b;
  --bg-main: #0f172a;
  --bg-card: #1e293b;
  --bg-panel: #334155;
  --text-primary: #f1f5f9;
  --text-secondary: #cbd5e1;
  --border: #475569;
  --shadow: rgba(0, 0, 0, 0.3);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: 'Poppins', sans-serif;
}

body {
  background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
  color: var(--text-primary);
  padding: 2rem 1rem;
  min-height: 100vh;
  position: relative;
  overflow-x: hidden;
}

body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: 
    radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 80% 80%, rgba(6, 182, 212, 0.1) 0%, transparent 50%);
  pointer-events: none;
  z-index: 0;
}

main {
  max-width: 1400px;
  margin: auto;
  position: relative;
  z-index: 1;
}

.user-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--bg-card);
  padding: 1rem 1.5rem;
  border-radius: 16px;
  margin-bottom: 2rem;
  border: 1px solid var(--border);
}

.user-info {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.user-avatar {
  width: 50px;
  height: 50px;
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
}

.user-details h3 {
  font-size: 1.1rem;
  margin-bottom: 0.25rem;
}

.user-details p {
  font-size: 0.9rem;
  color: var(--text-secondary);
}

.logout-btn {
  padding: 0.75rem 1.5rem;
  background: var(--error);
  color: white;
  border: none;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.logout-btn:hover {
  background: #dc2626;
  transform: translateY(-2px);
}

h1 {
  text-align: center;
  font-size: 2.5rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--primary-light) 0%, var(--secondary) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 2rem;
  text-shadow: 0 0 30px rgba(99, 102, 241, 0.3);
}

h2 {
  color: var(--text-primary);
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: 1rem;
}

.header-section {
  background: var(--bg-card);
  border-radius: 20px;
  padding: 2rem;
  margin-bottom: 2rem;
  box-shadow: 0 10px 40px var(--shadow);
  border: 1px solid var(--border);
  backdrop-filter: blur(10px);
}

.selection-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.5rem;
  margin-bottom: 1.5rem;
}

.header-section label {
  display: block;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 0.75rem;
  font-size: 1.1rem;
}

select {
  width: 100%;
  padding: 1rem 1.25rem;
  border-radius: 12px;
  border: 2px solid var(--border);
  background: var(--bg-panel);
  color: var(--text-primary);
  font-size: 1rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
  appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23cbd5e1' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 1rem center;
  background-size: 20px;
  padding-right: 3rem;
}

select:hover {
  border-color: var(--primary-light);
  background-color: var(--bg-card);
}

select:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.2);
}

.tutorial {
  background: linear-gradient(135deg, rgba(6, 182, 212, 0.15) 0%, rgba(6, 182, 212, 0.05) 100%);
  padding: 1.5rem;
  border-radius: 16px;
  margin: 1.5rem 0;
  border-left: 4px solid var(--secondary);
  border: 1px solid rgba(6, 182, 212, 0.3);
  backdrop-filter: blur(10px);
}

.tutorial h3 {
  color: var(--secondary);
  font-size: 1.2rem;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.tutorial p {
  color: var(--text-secondary);
  font-size: 1rem;
  line-height: 1.6;
  margin-bottom: 0.75rem;
}

.tutorial code {
  background: rgba(0, 0, 0, 0.3);
  padding: 2px 6px;
  border-radius: 4px;
  font-family: 'JetBrains Mono', monospace;
  color: var(--secondary);
}

.tutorial ul {
  margin-left: 1.5rem;
  margin-top: 0.5rem;
}

.tutorial li {
  margin-bottom: 0.5rem;
}

.tutorial pre {
  background: var(--bg-main);
  padding: 1rem;
  border-radius: 8px;
  overflow-x: auto;
  margin: 0.75rem 0;
  border: 1px solid var(--border);
}

.tutorial pre code {
  background: none;
  padding: 0;
  color: var(--text-primary);
}

.course {
  background: linear-gradient(135deg, rgba(245, 158, 11, 0.15) 0%, rgba(245, 158, 11, 0.05) 100%);
  padding: 1.5rem;
  border-radius: 16px;
  margin: 1.5rem 0;
  border-left: 4px solid var(--accent);
  border: 1px solid rgba(245, 158, 11, 0.3);
  backdrop-filter: blur(10px);
}

.course p {
  color: var(--text-secondary);
  font-size: 1rem;
  line-height: 1.6;
}

.course code {
  background: rgba(0, 0, 0, 0.3);
  padding: 2px 6px;
  border-radius: 4px;
  font-family: 'JetBrains Mono', monospace;
  color: var(--accent);
}

#activityDesc {
  text-align: center;
  font-size: 1.1rem;
  color: var(--text-secondary);
  margin-bottom: 1rem;
  font-weight: 500;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
  margin: 1.5rem 0;
}

.stat-card {
  background: var(--bg-panel);
  padding: 1rem;
  border-radius: 12px;
  text-align: center;
  border: 1px solid var(--border);
}

.stat-value {
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--primary-light);
  margin-bottom: 0.25rem;
}

.stat-label {
  font-size: 0.85rem;
  color: var(--text-secondary);
}

.progress-section {
  background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 100%);
  padding: 1.5rem;
  border-radius: 16px;
  margin: 1.5rem 0;
  border: 1px solid rgba(16, 185, 129, 0.3);
  text-align: center;
}

.progress-bar-container {
  background: var(--bg-main);
  border-radius: 12px;
  height: 30px;
  overflow: hidden;
  margin: 1rem 0;
  border: 1px solid var(--border);
}

.progress-bar {
  height: 100%;
  background: linear-gradient(90deg, var(--success) 0%, #059669 100%);
  transition: width 0.5s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 0.9rem;
}

.board {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
  margin-top: 2rem;
}

.panel {
  background: var(--bg-card);
  padding: 2rem;
  border-radius: 20px;
  box-shadow: 0 10px 40px var(--shadow);
  border: 1px solid var(--border);
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

.panel:hover {
  box-shadow: 0 15px 50px rgba(99, 102, 241, 0.2);
  border-color: var(--primary);
}

.panel h2 {
  text-align: center;
  margin-bottom: 1.5rem;
  padding-bottom: 1rem;
  border-bottom: 2px solid var(--border);
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.drop-zone {
  min-height: 320px;
  border: 2px dashed var(--border);
  border-radius: 16px;
  padding: 1rem;
  background: rgba(15, 23, 42, 0.5);
  transition: all 0.3s ease;
}

.drop-zone:hover {
  border-color: var(--primary-light);
  background: rgba(99, 102, 241, 0.05);
}

.code-line {
  background: linear-gradient(135deg, var(--bg-panel) 0%, var(--bg-card) 100%);
  padding: 0.9rem 1.2rem;
  border-radius: 12px;
  margin-bottom: 0.75rem;
  cursor: grab;
  user-select: none;
  transition: all 0.3s ease;
  display: block;
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.95rem;
  border: 1px solid var(--border);
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  position: relative;
  overflow: hidden;
}

.code-line::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 4px;
  height: 100%;
  background: var(--primary);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.code-line:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
  border-color: var(--primary);
}

.code-line:hover::before {
  opacity: 1;
}

.code-line:active {
  cursor: grabbing;
}

.code-line.fixed {
  cursor: default;
  background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
  border-color: rgba(99, 102, 241, 0.3);
}

.code-line.fixed:hover {
  transform: none;
}

.drop-slot {
  background: linear-gradient(135deg, rgba(245, 158, 11, 0.2) 0%, rgba(245, 158, 11, 0.1) 100%);
  padding: 4px 12px;
  border-radius: 8px;
  border: 2px dashed var(--accent);
  cursor: pointer;
  display: inline-block;
  min-width: 100px;
  text-align: center;
  font-weight: 600;
  transition: all 0.3s ease;
  animation: pulse 2s ease-in-out infinite;
}

.drop-slot.filled {
  background: linear-gradient(135deg, rgba(16, 185, 129, 0.3) 0%, rgba(16, 185, 129, 0.2) 100%);
  border: 2px solid var(--success);
  animation: none;
  color: var(--success);
}

.drop-slot.error {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.3) 0%, rgba(239, 68, 68, 0.2) 100%);
  border: 2px solid var(--error);
  animation: shake 0.5s ease;
  color: var(--error);
}

@keyframes pulse {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4);
  }
  50% {
    box-shadow: 0 0 0 8px rgba(245, 158, 11, 0);
  }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

.dragging {
  opacity: 0.4;
  transform: scale(1.05) rotate(2deg);
}

.editor-section {
  background: var(--bg-card);
  padding: 2rem;
  border-radius: 20px;
  margin-top: 2rem;
  box-shadow: 0 10px 40px var(--shadow);
  border: 1px solid var(--border);
}

.editor-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  flex-wrap: wrap;
  gap: 1rem;
}

.auto-update-indicator {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  background: var(--bg-panel);
  border-radius: 8px;
  font-size: 0.9rem;
  color: var(--text-secondary);
}

.auto-update-indicator .dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--success);
  animation: blink 2s ease-in-out infinite;
}

@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.3; }
}

.code-editor-wrapper {
  position: relative;
  border-radius: 16px;
  overflow: hidden;
  border: 2px solid var(--border);
  background: #1e1e1e;
  transition: all 0.3s ease;
}

.code-editor-wrapper:focus-within {
  border-color: var(--primary);
  box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.2);
}

#monacoEditor {
  height: 400px;
  width: 100%;
}

.compiler-section {
  background: var(--bg-card);
  padding: 2rem;
  border-radius: 20px;
  margin-top: 2rem;
  box-shadow: 0 10px 40px var(--shadow);
  border: 1px solid var(--border);
}

.iframe-container {
  position: relative;
  border-radius: 16px;
  overflow: hidden;
  border: 2px solid var(--border);
  background: white;
  height: 500px;
  margin-top: 1rem;
}

.iframe-container iframe {
  width: 100%;
  height: 100%;
  border: none;
}

.button-container {
  text-align: center;
  margin-top: 2rem;
  display: flex;
  gap: 1rem;
  justify-content: center;
  flex-wrap: wrap;
}

button {
  padding: 1rem 3rem;
  border: none;
  border-radius: 16px;
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color: white;
  font-size: 1.1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
  position: relative;
  overflow: hidden;
}

button.success-btn {
  background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
  box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
}

button.secondary-btn {
  background: linear-gradient(135deg, var(--secondary) 0%, #0891b2 100%);
  box-shadow: 0 10px 30px rgba(6, 182, 212, 0.4);
}

button::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.2);
  transform: translate(-50%, -50%);
  transition: width 0.6s ease, height 0.6s ease;
}

button:hover::before {
  width: 300px;
  height: 300px;
}

button:hover {
  transform: translateY(-3px);
  box-shadow: 0 15px 40px rgba(99, 102, 241, 0.6);
}

button.success-btn:hover {
  box-shadow: 0 15px 40px rgba(16, 185, 129, 0.6);
}

button.secondary-btn:hover {
  box-shadow: 0 15px 40px rgba(6, 182, 212, 0.6);
}

button:active {
  transform: translateY(-1px);
}

button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.notification {
  position: fixed;
  top: 2rem;
  right: 2rem;
  padding: 1.5rem 2rem;
  border-radius: 16px;
  background: var(--bg-card);
  border: 2px solid;
  box-shadow: 0 10px 40px var(--shadow);
  z-index: 1000;
  transform: translateX(400px);
  transition: transform 0.5s ease;
  max-width: 400px;
}

.notification.show {
  transform: translateX(0);
}

.notification.success {
  border-color: var(--success);
  background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(16, 185, 129, 0.1) 100%);
}

.notification.error {
  border-color: var(--error);
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(239, 68, 68, 0.1) 100%);
}

.notification h4 {
  font-size: 1.1rem;
  margin-bottom: 0.5rem;
}

.notification.success h4 {
  color: var(--success);
}

.notification.error h4 {
  color: var(--error);
}

@media (max-width: 900px) {
  .board, .selection-grid {
    grid-template-columns: 1fr;
  }
  
  h1 {
    font-size: 2rem;
  }
  
  .panel {
    padding: 1.5rem;
  }
  
  .notification {
    right: 1rem;
    left: 1rem;
    max-width: none;
  }
  
  .stats-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 600px) {
  body {
    padding: 1rem 0.5rem;
  }
  
  h1 {
    font-size: 1.8rem;
  }
  
  .header-section {
    padding: 1.5rem;
  }
  
  .panel {
    padding: 1rem;
  }
  
  button {
    padding: 0.9rem 2rem;
    font-size: 1rem;
  }
  
  .button-container {
    flex-direction: column;
  }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.panel, .header-section, .editor-section, .compiler-section {
  animation: fadeInUp 0.6s ease backwards;
}

.panel:nth-child(1) { animation-delay: 0.1s; }
.panel:nth-child(2) { animation-delay: 0.2s; }
</style>
</head>
<body>
<main>
<div class="user-header">
  <div class="user-info">
    <div class="user-avatar">üë§</div>
    <div class="user-details">
      <h3 id="userName">Loading...</h3>
      <p id="userStats">Session: <span id="sessionTime">0:00</span></p>
    </div>
  </div>
  <button class="logout-btn" onclick="logout()">Logout</button>
</div>

<h1>üéì TP1 - Apprendre C++</h1>

<div class="header-section">
  <div class="selection-grid">
    <div>
      <label for="categorySelect">üìö Cat√©gorie :</label>
      <select id="categorySelect"></select>
    </div>
    <div>
      <label for="activitySelect">üéØ Activit√© :</label>
      <select id="activitySelect"></select>
    </div>
  </div>
  
  <div id="activityTutorial" class="tutorial"></div>
  <div id="activityCourse" class="course"></div>
  <p id="activityDesc"></p>
  
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-value" id="statCorrect">0</div>
      <div class="stat-label">‚úÖ Correct</div>
    </div>
    <div class="stat-card">
      <div class="stat-value" id="statErrors">0</div>
      <div class="stat-label">‚ùå Errors</div>
    </div>
    <div class="stat-card">
      <div class="stat-value" id="statTime">0:00</div>
      <div class="stat-label">‚è±Ô∏è Time</div>
    </div>
  </div>
  
  <div class="progress-section">
    <h3 style="color: var(--success); margin-bottom: 0.5rem;">üìä Progression</h3>
    <div class="progress-bar-container">
      <div class="progress-bar" id="progressBar" style="width: 0%;">0%</div>
    </div>
    <p id="progressText" style="color: var(--text-secondary); font-size: 0.9rem;">Compl√©tez tous les emplacements pour continuer</p>
  </div>
</div>

<div class="board">
  <section class="panel">
    <h2>üß© Fragments disponibles</h2>
    <div id="pool" class="drop-zone"></div>
  </section>
  <section class="panel solution">
    <h2>‚ú® Code √† compl√©ter</h2>
    <div id="solution" class="drop-zone"></div>
  </section>
</div>

<div class="editor-section">
  <div class="editor-header">
    <h2>üíª √âditeur de code</h2>
    <div class="auto-update-indicator">
      <span class="dot"></span>
      Mise √† jour automatique
    </div>
  </div>
  
  <div class="code-editor-wrapper">
    <div id="monacoEditor"></div>
  </div>
</div>

<div class="compiler-section">
  <h2>üöÄ Compilateur C++ en ligne</h2>
  <p style="color: var(--text-secondary); margin-bottom: 1rem;">
    Le code est automatiquement synchronis√©. Utilisez le compilateur ci-dessous pour ex√©cuter votre programme.
  </p>
  
  <div class="iframe-container">
    <iframe
      src="https://onecompiler.com/embed/cpp"
      title="Online C++ Compiler">
    </iframe>
  </div>
</div>

<div class="button-container">
  <button class="secondary-btn" onclick="copyToCompiler()">üìã Copier le code</button>
  <button class="success-btn" onclick="resetActivity()">üîÑ R√©initialiser l'activit√©</button>
</div>

<div id="notification" class="notification"></div>
</main>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>

<script>
// === Firebase Configuration ===
const databaseURL = "https://programmation-87e30-default-rtdb.firebaseio.com/";

// === Session Management ===
let currentUser = null;
let sessionStartTime = null;
let activityStartTime = null;
let sessionTimer = null;
let activityTimer = null;

// Activity tracking
let currentActivityStats = {
  correctAttempts: 0,
  errorAttempts: 0,
  timeSpent: 0
};

// Check authentication
function checkAuth() {
  const session = sessionStorage.getItem('userSession');
  if (!session) {
    window.location.href = 'login.html';
    return false;
  }
  
  currentUser = JSON.parse(session);
  sessionStartTime = new Date(currentUser.loginTime);
  
  // Display user info
  document.getElementById('userName').textContent = `${currentUser.name} ${currentUser.lastname}`;
  
  // Start session timer
  startSessionTimer();
  
  return true;
}

// Session timer
function startSessionTimer() {
  updateSessionTime();
  sessionTimer = setInterval(updateSessionTime, 1000);
}

function updateSessionTime() {
  const now = new Date();
  const diff = Math.floor((now - sessionStartTime) / 1000);
  const minutes = Math.floor(diff / 60);
  const seconds = diff % 60;
  document.getElementById('sessionTime').textContent = 
    `${minutes}:${seconds.toString().padStart(2, '0')}`;
}

// Activity timer
function startActivityTimer() {
  activityStartTime = new Date();
  updateActivityTime();
  activityTimer = setInterval(updateActivityTime, 1000);
}

function updateActivityTime() {
  if (!activityStartTime) return;
  const now = new Date();
  const diff = Math.floor((now - activityStartTime) / 1000);
  const minutes = Math.floor(diff / 60);
  const seconds = diff % 60;
  document.getElementById('statTime').textContent = 
    `${minutes}:${seconds.toString().padStart(2, '0')}`;
  currentActivityStats.timeSpent = diff;
}

function stopActivityTimer() {
  if (activityTimer) {
    clearInterval(activityTimer);
    activityTimer = null;
  }
}

// Update stats display
function updateStatsDisplay() {
  document.getElementById('statCorrect').textContent = currentActivityStats.correctAttempts;
  document.getElementById('statErrors').textContent = currentActivityStats.errorAttempts;
}

// Save activity data to Firebase
async function saveActivityData(completed = false) {
  if (!currentUser || !currentActivity) return;
  
  const activityKey = `${currentCategory.id}_${currentActivity.id}`;
  const timestamp = new Date().toISOString();
  
  const activityData = {
    categoryId: currentCategory.id,
    categoryName: currentCategory.name,
    activityId: currentActivity.id,
    activityName: currentActivity.plan,
    correctAttempts: currentActivityStats.correctAttempts,
    errorAttempts: currentActivityStats.errorAttempts,
    timeSpent: currentActivityStats.timeSpent,
    completed: completed,
    lastAccess: timestamp,
    timestamp: timestamp
  };
  
  try {
    // Save to student's activity log
    await fetch(`${databaseURL}/students/${currentUser.studentId}/activities/${activityKey}.json`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(activityData)
    });
    
    // Update last activity timestamp
    await fetch(`${databaseURL}/students/${currentUser.studentId}.json`, {
      method: 'PATCH',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        lastActivity: timestamp,
        lastActivityName: activityData.activityName
      })
    });
    
    console.log('Activity data saved successfully');
  } catch (error) {
    console.error('Error saving activity data:', error);
  }
}

// Logout function
function logout() {
  if (confirm('Are you sure you want to logout?')) {
    // Save final activity data
    saveActivityData();
    
    // Clear session
    sessionStorage.removeItem('userSession');
    
    // Clear timers
    if (sessionTimer) clearInterval(sessionTimer);
    if (activityTimer) clearInterval(activityTimer);
    
    // Redirect to login
    window.location.href = 'login.html';
  }
}

// Auto-save activity data every 30 seconds
setInterval(() => {
  if (currentUser && currentActivity) {
    saveActivityData();
  }
}, 30000);

// Save on page unload
window.addEventListener('beforeunload', () => {
  if (currentUser && currentActivity) {
    saveActivityData();
  }
});

// === CAT√âGORIES ET ACTIVIT√âS ===
const categories = [
  {
    "id": "variables_types",
    "name": "Variables et Types de Donn√©es",
    "icon": "",
    "activities": [
      {
        "id": 1,
        "plan": "D√©claration de variables",
        "description": "D√©clarer int, float, char",
        "tutorial": "<h3> Tutoriel : Types de donn√©es de base</h3>\n<p>C++ propose plusieurs types de donn√©es fondamentaux :</p>\n<ul style=\"margin-left: 1.5rem; margin-top: 0.5rem;\">\n<li><code>int</code> : nombres entiers (ex: 42, -10)</li>\n<li><code>float</code> : nombres d√©cimaux (ex: 3.14, -2.5)</li>\n<li><code>char</code> : un seul caract√®re (ex: 'A', 'z')</li>\n<li><code>bool</code> : vrai ou faux (true/false)</li>\n</ul>\n<p>Vous pouvez d√©clarer plusieurs variables de types diff√©rents dans le m√™me programme.</p>",
        "course": "<p>D√©clarez des variables de diff√©rents types et affichez-les.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "__PH4__",
          "__PH5__",
          "std::cout << age << std::endl;",
          "std::cout << prix << std::endl;",
          "std::cout << grade << std::endl;",
          "__PH6__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int age = 25;",
          "__PH4__": "float prix = 19.99;",
          "__PH5__": "char grade = 'A';",
          "__PH6__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int age = 25;",
          "float prix = 19.99;",
          "char grade = 'A';",
          "std::cout << age << std::endl;",
          "std::cout << prix << std::endl;",
          "std::cout << grade << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "25\n19.99\nA"
      },
      {
        "id": 2,
        "plan": "Type bool",
        "description": "Afficher true et false",
        "tutorial": "<h3> Tutoriel : Type bool√©en</h3>\n<p>Le type <code>bool</code> ne peut avoir que deux valeurs : <code>true</code> (vrai) ou <code>false</code> (faux).</p>\n<p><strong>Affichage :</strong></p>\n<ul style=\"margin-left: 1.5rem; margin-top: 0.5rem;\">\n<li><code>true</code> s'affiche comme <code>1</code></li>\n<li><code>false</code> s'affiche comme <code>0</code></li>\n</ul>\n<p>Pour afficher \"true\" ou \"false\" en texte, utilisez <code>std::boolalpha</code>.</p>\n<pre><code class=\"language-cpp\">bool estVrai = true;\nstd::cout << std::boolalpha << estVrai;  // affiche \"true\"</code></pre>",
        "course": "<p>D√©clarez des variables bool√©ennes et affichez leurs valeurs.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "__PH4__",
          "std::cout << estVrai << std::endl;",
          "std::cout << estFaux << std::endl;",
          "__PH5__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "bool estVrai = true;",
          "__PH4__": "bool estFaux = false;",
          "__PH5__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "bool estVrai = true;",
          "bool estFaux = false;",
          "std::cout << estVrai << std::endl;",
          "std::cout << estFaux << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "1\n0"
      },
      {
        "id": 3,
        "plan": "Constantes",
        "description": "D√©clarer et afficher des constantes",
        "tutorial": "<h3> Tutoriel : Constantes</h3>\n<p>Le mot-cl√© <code>const</code> permet de d√©clarer une valeur qui ne peut pas √™tre modifi√©e :</p>\n<pre><code class=\"language-cpp\">const int MAX = 100;\nstd::cout << MAX;</code></pre>",
        "course": "<p>D√©clarez une constante et affichez-la.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "std::cout << MAX << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "const int MAX = 100;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "const int MAX = 100;",
          "std::cout << MAX << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "100"
      },
      {
        "id": 4,
        "plan": "Type double",
        "description": "Travailler avec des nombres d√©cimaux plus pr√©cis",
        "tutorial": "<h3> Tutoriel : Type double</h3>\n<p>Le type <code>double</code> permet de stocker des nombres d√©cimaux avec plus de pr√©cision qu'un float :</p>\n<pre><code class=\"language-cpp\">double pi = 3.1415926535;\nstd::cout << pi;</code></pre>",
        "course": "<p>D√©clarez une variable double et affichez-la.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "std::cout << pi << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "double pi = 3.1415926535;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "double pi = 3.1415926535;",
          "std::cout << pi << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "3.14159"
      },
      {
        "id": 5,
        "plan": "Type string",
        "description": "D√©clarer et afficher des cha√Ænes de caract√®res",
        "tutorial": "<h3> Tutoriel : Type string</h3>\n<p>En C++, une cha√Æne de caract√®res peut √™tre d√©clar√©e avec <code>std::string</code> :</p>\n<pre><code class=\"language-cpp\">std::string nom = \"Alice\";\nstd::cout << nom;</code></pre>",
        "course": "<p>D√©clarez une variable string et affichez-la.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "std::cout << nom << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {\n    std::string nom = \"Alice\";",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "int main() {",
          "std::string nom = \"Alice\";",
          "std::cout << nom << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "Alice"
      },
      {
        "id": 6,
        "plan": "Type auto",
        "description": "Laisser le compilateur inf√©rer le type",
        "tutorial": "<h3> Tutoriel : Type auto</h3>\n<p>Le mot-cl√© <code>auto</code> permet au compilateur de d√©terminer le type de la variable automatiquement :</p>\n<pre><code class=\"language-cpp\">auto x = 42;   // int\nauto y = 3.14; // double</code></pre>",
        "course": "<p>D√©clarez des variables avec <code>auto</code> et affichez-les.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "__PH4__",
          "std::cout << x << std::endl;",
          "std::cout << y << std::endl;",
          "__PH5__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "auto x = 42;",
          "__PH4__": "auto y = 3.14;",
          "__PH5__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "auto x = 42;",
          "auto y = 3.14;",
          "std::cout << x << std::endl;",
          "std::cout << y << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "42\n3.14"
      },
      {
        "id": 7,
        "plan": "Modification de variables",
        "description": "Changer la valeur d'une variable",
        "tutorial": "<h3> Tutoriel : Modification de variables</h3>\n<p>Une variable peut √™tre modifi√©e apr√®s sa d√©claration :</p>\n<pre><code class=\"language-cpp\">int age = 20;\nage = 25;\nstd::cout << age;</code></pre>",
        "course": "<p>D√©clarez une variable int, modifiez sa valeur et affichez-la.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "age = 25;",
          "std::cout << age << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int age = 20;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int age = 20;",
          "age = 25;",
          "std::cout << age << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "25"
      },
      {
        "id": 8,
        "plan": "Constantes float",
        "description": "D√©clarer des constantes float",
        "tutorial": "<h3> Tutoriel : Constantes float</h3>\n<p>Vous pouvez cr√©er des constantes de type float :</p>\n<pre><code class=\"language-cpp\">const float TAXE = 0.2;\nstd::cout << TAXE;</code></pre>",
        "course": "<p>D√©clarez une constante float et affichez-la.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "std::cout << TAXE << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "const float TAXE = 0.2;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "const float TAXE = 0.2;",
          "std::cout << TAXE << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "0.2"
      }
    ]
  },
  {
    "id": "entree_sortie",
    "name": "Entr√©e et Sortie",
    "icon": "",
    "activities": [
      {
        "id": 1,
        "plan": "Saisie d'un entier",
        "description": "Lire un entier avec std::cin",
        "tutorial": "<h3> Tutoriel : Lire un entier</h3>\n<p>Utilisez <code>std::cin</code> pour lire un entier saisi par l'utilisateur :</p>\n<pre><code class=\"language-cpp\">int n;\nstd::cout << \"Entrez un entier : \";\nstd::cin >> n;\nstd::cout << \"Vous avez saisi : \" << n;</code></pre>",
        "course": "<p>Demandez √† l'utilisateur de saisir un entier et affichez-le.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "std::cin >> n;",
          "std::cout << n << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int n;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int n;",
          "std::cin >> n;",
          "std::cout << n << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "5"
      },
      {
        "id": 2,
        "plan": "Saisie d'un flottant",
        "description": "Lire un nombre d√©cimal",
        "tutorial": "<h3> Tutoriel : Lire un flottant</h3>\n<p>Pour lire un nombre √† virgule, utilisez <code>float</code> ou <code>double</code> :</p>\n<pre><code class=\"language-cpp\">float x;\nstd::cout << \"Entrez un nombre : \";\nstd::cin >> x;\nstd::cout << \"Vous avez entr√© : \" << x;</code></pre>",
        "course": "<p>Lire un nombre d√©cimal depuis l'utilisateur et l'afficher.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "std::cin >> x;",
          "std::cout << x << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "float x;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "float x;",
          "std::cin >> x;",
          "std::cout << x << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "3.14"
      },
      {
        "id": 3,
        "plan": "Saisie d'un mot",
        "description": "Lire un mot avec std::cin",
        "tutorial": "<h3> Tutoriel : Lire une cha√Æne simple</h3>\n<p><code>std::cin</code> lit une cha√Æne jusqu'au premier espace :</p>\n<pre><code class=\"language-cpp\">std::string mot;\nstd::cout << \"Entrez un mot : \";\nstd::cin >> mot;\nstd::cout << \"Mot saisi : \" << mot;</code></pre>",
        "course": "<p>Lire un mot et l'afficher.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "__PH4__",
          "std::cin >> mot;",
          "std::cout << mot << std::endl;",
          "__PH5__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {",
          "__PH4__": "std::string mot;",
          "__PH5__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "int main() {",
          "std::string mot;",
          "std::cin >> mot;",
          "std::cout << mot << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "Bonjour"
      },
      {
        "id": 4,
        "plan": "Affichage texte et variable",
        "description": "Combiner texte et variable",
        "tutorial": "<h3> Tutoriel : Affichage format√©</h3>\n<p>Vous pouvez combiner texte et variable :</p>\n<pre><code class=\"language-cpp\">int age = 18;\nstd::cout << \"Age : \" << age;</code></pre>",
        "course": "<p>Afficher un message combin√© avec une variable.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "std::cout << \"Age : \" << age << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int age = 18;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int age = 18;",
          "std::cout << \"Age : \" << age << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "Age : 18"
      },
      {
        "id": 5,
        "plan": "Saisie de deux nombres",
        "description": "Lire et afficher deux nombres",
        "tutorial": "<h3> Tutoriel : Lecture multiple</h3>\n<p>Vous pouvez lire plusieurs valeurs successivement :</p>\n<pre><code class=\"language-cpp\">int a, b;\nstd::cin >> a >> b;\nstd::cout << a << \" \" << b;</code></pre>",
        "course": "<p>Lire deux entiers et les afficher s√©par√©s par un espace.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "std::cin >> a >> b;",
          "std::cout << a << \" \" << b << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int a, b;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int a, b;",
          "std::cin >> a >> b;",
          "std::cout << a << \" \" << b << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "4 7"
      },
      {
        "id": 6,
        "plan": "Saisie d'une ligne compl√®te",
        "description": "Lire une phrase avec getline",
        "tutorial": "<h3> Tutoriel : Lire une ligne compl√®te</h3>\n<p>Utilisez <code>std::getline</code> pour lire une ligne enti√®re :</p>\n<pre><code class=\"language-cpp\">std::string phrase;\nstd::getline(std::cin, phrase);\nstd::cout << \"Phrase : \" << phrase;</code></pre>",
        "course": "<p>Lire et afficher une phrase compl√®te saisie par l'utilisateur.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "__PH4__",
          "std::getline(std::cin, phrase);",
          "std::cout << phrase << std::endl;",
          "__PH5__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {",
          "__PH4__": "std::string phrase;",
          "__PH5__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "int main() {",
          "std::string phrase;",
          "std::getline(std::cin, phrase);",
          "std::cout << phrase << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "Bonjour tout le monde"
      },
      {
        "id": 7,
        "plan": "Affichage bool√©en",
        "description": "Afficher true ou false en texte",
        "tutorial": "<h3> Tutoriel : Affichage bool√©en</h3>\n<p>Pour afficher un bool√©en en texte :</p>\n<pre><code class=\"language-cpp\">bool actif = true;\nstd::cout << std::boolalpha << actif;</code></pre>",
        "course": "<p>Afficher la valeur d'une variable bool en texte.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "std::cout << std::boolalpha << actif << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "bool actif = true;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "bool actif = true;",
          "std::cout << std::boolalpha << actif << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "true"
      },
      {
        "id": 8,
        "plan": "Affichage avec format num√©rique",
        "description": "Afficher un float avec pr√©cision",
        "tutorial": "<h3> Tutoriel : Affichage num√©rique</h3>\n<p>Vous pouvez formater un nombre d√©cimal :</p>\n<pre><code class=\"language-cpp\">float pi = 3.14159;\nstd::cout << std::fixed << std::setprecision(2) << pi;</code></pre>",
        "course": "<p>Afficher un nombre d√©cimal avec deux chiffres apr√®s la virgule.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "__PH4__",
          "std::cout << std::fixed << std::setprecision(2) << pi << std::endl;",
          "__PH5__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <iomanip>",
          "__PH3__": "int main() {",
          "__PH4__": "float pi = 3.14159;",
          "__PH5__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <iomanip>",
          "int main() {",
          "float pi = 3.14159;",
          "std::cout << std::fixed << std::setprecision(2) << pi << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "3.14"
      }
    ]
  },
  {
    "id": "operateurs_expressions",
    "name": "Op√©rateurs et Expressions",
    "icon": "",
    "activities": [
      {
        "id": 1,
        "plan": "Addition simple",
        "description": "Ajouter deux nombres et afficher le r√©sultat",
        "tutorial": "<h3> Tutoriel : Addition</h3>\n<p>Utilisez l'op√©rateur <code>+</code> pour additionner deux nombres :</p>\n<pre><code class=\"language-cpp\">int a = 5, b = 3;\nint somme = a + b;\nstd::cout << somme;</code></pre>",
        "course": "<p>Calculez la somme de deux nombres et affichez-la.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "int somme = a + b;",
          "std::cout << somme << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int a = 5, b = 3;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int a = 5, b = 3;",
          "int somme = a + b;",
          "std::cout << somme << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "8"
      },
      {
        "id": 2,
        "plan": "Soustraction simple",
        "description": "Soustraire deux nombres",
        "tutorial": "<h3> Tutoriel : Soustraction</h3>\n<p>L'op√©rateur <code>-</code> permet de soustraire deux nombres :</p>\n<pre><code class=\"language-cpp\">int a = 10, b = 4;\nint diff = a - b;\nstd::cout << diff;</code></pre>",
        "course": "<p>Calculez la diff√©rence de deux nombres et affichez-la.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "int diff = a - b;",
          "std::cout << diff << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int a = 10, b = 4;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int a = 10, b = 4;",
          "int diff = a - b;",
          "std::cout << diff << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "6"
      },
      {
        "id": 3,
        "plan": "Multiplication",
        "description": "Multiplier deux nombres",
        "tutorial": "<h3> Tutoriel : Multiplication</h3>\n<p>L'op√©rateur <code>*</code> multiplie deux nombres :</p>\n<pre><code class=\"language-cpp\">int a = 7, b = 6;\nint produit = a * b;\nstd::cout << produit;</code></pre>",
        "course": "<p>Calculez le produit de deux nombres et affichez-le.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "int produit = a * b;",
          "std::cout << produit << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int a = 7, b = 6;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int a = 7, b = 6;",
          "int produit = a * b;",
          "std::cout << produit << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "42"
      },
      {
        "id": 4,
        "plan": "Division enti√®re",
        "description": "Diviser deux nombres entiers",
        "tutorial": "<h3> Tutoriel : Division enti√®re</h3>\n<p>L'op√©rateur <code>/</code> permet de diviser :</p>\n<pre><code class=\"language-cpp\">int a = 10, b = 3;\nint div = a / b;\nstd::cout << div;</code></pre>",
        "course": "<p>Divisez deux entiers et affichez le r√©sultat (partie enti√®re).</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "int div = a / b;",
          "std::cout << div << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int a = 10, b = 3;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int a = 10, b = 3;",
          "int div = a / b;",
          "std::cout << div << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "3"
      },
      {
        "id": 5,
        "plan": "Incr√©mentation",
        "description": "Utiliser ++ et --",
        "tutorial": "<h3> Tutoriel : Op√©rateurs d'incr√©mentation</h3>\n<p>Les op√©rateurs <code>++</code> et <code>--</code> modifient la valeur d'une variable.</p>\n<ul style=\"margin-left: 1.5rem; margin-top: 0.5rem;\">\n<li><code>x++</code> : incr√©mente x de 1 (post-incr√©mentation)</li>\n<li><code>++x</code> : incr√©mente x de 1 (pr√©-incr√©mentation)</li>\n<li><code>x--</code> : d√©cr√©mente x de 1 (post-d√©cr√©mentation)</li>\n<li><code>--x</code> : d√©cr√©mente x de 1 (pr√©-d√©cr√©mentation)</li>\n</ul>",
        "course": "<p>Utilisez les op√©rateurs <code>++</code> et <code>--</code> pour modifier des variables.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "compteur++;",
          "std::cout << compteur << std::endl;",
          "compteur--;",
          "std::cout << compteur << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int compteur = 10;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int compteur = 10;",
          "compteur++;",
          "std::cout << compteur << std::endl;",
          "compteur--;",
          "std::cout << compteur << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "11\n10"
      },
      {
        "id": 6,
        "plan": "Op√©rateurs compos√©s",
        "description": "Utiliser += et *=",
        "tutorial": "<h3> Tutoriel : Op√©rateurs d'affectation compos√©s</h3>\n<p>Ces op√©rateurs combinent une op√©ration et une affectation :</p>\n<ul style=\"margin-left: 1.5rem; margin-top: 0.5rem;\">\n<li><code>x += 5</code> √©quivaut √† <code>x = x + 5</code></li>\n<li><code>x -= 3</code> √©quivaut √† <code>x = x - 3</code></li>\n<li><code>x *= 2</code> √©quivaut √† <code>x = x * 2</code></li>\n<li><code>x /= 4</code> √©quivaut √† <code>x = x / 4</code></li>\n</ul>",
        "course": "<p>Utilisez les op√©rateurs compos√©s pour modifier des variables.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "valeur += 5;",
          "std::cout << valeur << std::endl;",
          "valeur *= 2;",
          "std::cout << valeur << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int valeur = 10;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int valeur = 10;",
          "valeur += 5;",
          "std::cout << valeur << std::endl;",
          "valeur *= 2;",
          "std::cout << valeur << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "15\n30"
      },
      {
        "id": 7,
        "plan": "Modulo",
        "description": "Calculer le reste d'une division",
        "tutorial": "<h3> Tutoriel : Op√©rateur modulo</h3>\n<p>L'op√©rateur <code>%</code> retourne le reste d'une division enti√®re :</p>\n<pre><code class=\"language-cpp\">int a = 17, b = 5;\nint reste = a % b;\nstd::cout << reste;</code></pre>",
        "course": "<p>Calculez le reste de la division de deux nombres et affichez-le.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "int reste = a % b;",
          "std::cout << reste << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int a = 17, b = 5;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int a = 17, b = 5;",
          "int reste = a % b;",
          "std::cout << reste << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "2"
      },
      {
        "id": 8,
        "plan": "Priorit√© des op√©rations",
        "description": "Combiner plusieurs op√©rateurs",
        "tutorial": "<h3> Tutoriel : Priorit√© des op√©rateurs</h3>\n<p>Les op√©rations suivent les r√®gles classiques de priorit√© :</p>\n<pre><code class=\"language-cpp\">int resultat = 2 + 3 * 4;\nstd::cout << resultat;  // 14</code></pre>",
        "course": "<p>Calculez une expression combinant plusieurs op√©rateurs et affichez le r√©sultat.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "int resultat = 2 + 3 * 4;",
          "std::cout << resultat << std::endl;",
          "__PH3__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int resultat = 2 + 3 * 4;",
          "std::cout << resultat << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "14"
      }
    ]
  },
  {
    "id": "instructions_controle_flux",
    "name": "Instructions de contr√¥le de flux",
    "icon": "‚ùå",
    "activities": [
      {
        "id": 1,
        "plan": "Condition if",
        "description": "Tester si nombre positif",
        "tutorial": "<h3> Tutoriel : Instruction if</h3>\n<p>L'instruction <code>if</code> ex√©cute un bloc de code si une condition est vraie.</p>\n<p><strong>Syntaxe :</strong></p>\n<pre><code class=\"language-cpp\">if (condition) {\n    // code ex√©cut√© si condition vraie\n}</code></pre>\n<p><strong>Op√©rateurs de comparaison :</strong></p>\n<ul style=\"margin-left: 1.5rem; margin-top: 0.5rem;\">\n<li><code>></code> : sup√©rieur √†</li>\n<li><code><</code> : inf√©rieur √†</li>\n<li><code>>=</code> : sup√©rieur ou √©gal</li>\n<li><code><=</code> : inf√©rieur ou √©gal</li>\n<li><code>==</code> : √©gal √†</li>\n<li><code>!=</code> : diff√©rent de</li>\n</ul>",
        "course": "<p>Utilisez <code>if</code> pour tester si un nombre est positif.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "if (nombre > 0) {",
          "std::cout << \"Positif\" << std::endl;",
          "}",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int nombre = 5;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int nombre = 5;",
          "if (nombre > 0) {",
          "std::cout << \"Positif\" << std::endl;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "Positif"
      },
      {
        "id": 2,
        "plan": "if-else",
        "description": "Pair ou impair",
        "tutorial": "<h3> Tutoriel : if-else</h3>\n<p>L'instruction <code>else</code> permet d'ex√©cuter du code lorsque la condition du <code>if</code> est fausse.</p>\n<p><strong>Syntaxe :</strong></p>\n<pre><code class=\"language-cpp\">if (condition) {\n    // code si vrai\n} else {\n    // code si faux\n}</code></pre>\n<p>Pour tester si un nombre est pair, utilisez l'op√©rateur modulo : <code>nombre % 2 == 0</code></p>",
        "course": "<p>Utilisez <code>if-else</code> pour d√©terminer si un nombre est pair ou impair.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "if (n % 2 == 0) {",
          "std::cout << \"Pair\" << std::endl;",
          "} else {",
          "std::cout << \"Impair\" << std::endl;",
          "}",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int n = 8;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int n = 8;",
          "if (n % 2 == 0) {",
          "std::cout << \"Pair\" << std::endl;",
          "} else {",
          "std::cout << \"Impair\" << std::endl;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "Pair"
      },
      {
        "id": 3,
        "plan": "if-else if",
        "description": "√âvaluer plusieurs conditions",
        "tutorial": "<h3> Tutoriel : if-else if</h3>\n<p>Vous pouvez tester plusieurs conditions :</p>\n<pre><code class=\"language-cpp\">int note = 15;\nif (note >= 16) {\n    std::cout << \"Excellent\";\n} else if (note >= 10) {\n    std::cout << \"Passable\";\n} else {\n    std::cout << \"√âchec\";\n}</code></pre>",
        "course": "<p>√âvaluez une note et affichez le r√©sultat correspondant.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "if (note >= 16) {",
          "std::cout << \"Excellent\" << std::endl;",
          "} else if (note >= 10) {",
          "std::cout << \"Passable\" << std::endl;",
          "} else {",
          "std::cout << \"√âchec\" << std::endl;",
          "}",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int note = 12;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int note = 12;",
          "if (note >= 16) {",
          "std::cout << \"Excellent\" << std::endl;",
          "} else if (note >= 10) {",
          "std::cout << \"Passable\" << std::endl;",
          "} else {",
          "std::cout << \"√âchec\" << std::endl;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "Passable"
      },
      {
        "id": 4,
        "plan": "Ternary",
        "description": "Utiliser l'op√©rateur ternaire",
        "tutorial": "<h3> Tutoriel : Op√©rateur ternaire</h3>\n<p>L'op√©rateur ternaire est une forme compacte de if-else :</p>\n<pre><code class=\"language-cpp\">int age = 18;\nstd::string statut = (age >= 18) ? \"Majeur\" : \"Mineur\";\nstd::cout << statut;</code></pre>",
        "course": "<p>D√©terminez si quelqu'un est majeur ou mineur avec l'op√©rateur ternaire.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "__PH4__",
          "std::string statut = (age >= 18) ? \"Majeur\" : \"Mineur\";",
          "std::cout << statut << std::endl;",
          "__PH5__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {",
          "__PH4__": "int age = 20;",
          "__PH5__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "int main() {",
          "int age = 20;",
          "std::string statut = (age >= 18) ? \"Majeur\" : \"Mineur\";",
          "std::cout << statut << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "Majeur"
      },
      {
        "id": 5,
        "plan": "Boucle for simple",
        "description": "Afficher nombres de 1 √† 5",
        "tutorial": "<h3> Tutoriel : Boucle for</h3>\n<p>La boucle <code>for</code> permet de r√©p√©ter une action un nombre pr√©cis de fois :</p>\n<pre><code class=\"language-cpp\">for (int i = 1; i <= 5; i++) {\n    std::cout << i << \" \";\n}</code></pre>",
        "course": "<p>Affichez les nombres de 1 √† 5 avec une boucle <code>for</code>.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "for (int i = 1; i <= 5; i++) {",
          "std::cout << i << \" \";",
          "}",
          "__PH3__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "for (int i = 1; i <= 5; i++) {",
          "std::cout << i << \" \";",
          "}",
          "return 0;"
        ],
        "expectedOutput": "1 2 3 4 5 "
      },
      {
        "id": 6,
        "plan": "Boucle while",
        "description": "Compter de 1 √† 3",
        "tutorial": "<h3> Tutoriel : Boucle while</h3>\n<p>La boucle <code>while</code> r√©p√®te tant qu'une condition est vraie :</p>\n<pre><code class=\"language-cpp\">int i = 1;\nwhile (i <= 3) {\n    std::cout << i << \" \";\n    i++;\n}</code></pre>",
        "course": "<p>Affichez les nombres de 1 √† 3 avec une boucle <code>while</code>.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "while (i <= 3) {",
          "std::cout << i << \" \";",
          "i++;",
          "}",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int i = 1;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int i = 1;",
          "while (i <= 3) {",
          "std::cout << i << \" \";",
          "i++;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "1 2 3 "
      },
      {
        "id": 7,
        "plan": "Boucle do-while",
        "description": "Afficher au moins une fois",
        "tutorial": "<h3> Tutoriel : Boucle do-while</h3>\n<p>La boucle <code>do-while</code> ex√©cute toujours le bloc au moins une fois :</p>\n<pre><code class=\"language-cpp\">int i = 1;\ndo {\n    std::cout << i << \" \";\n    i++;\n} while (i <= 3);</code></pre>",
        "course": "<p>Affichez les nombres de 1 √† 3 avec une boucle <code>do-while</code>.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "do {",
          "std::cout << i << \" \";",
          "i++;",
          "} while (i <= 3);",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int i = 1;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int i = 1;",
          "do {",
          "std::cout << i << \" \";",
          "i++;",
          "} while (i <= 3);",
          "return 0;"
        ],
        "expectedOutput": "1 2 3 "
      },
      {
        "id": 8,
        "plan": "Break dans boucle",
        "description": "Arr√™ter une boucle for",
        "tutorial": "<h3> Tutoriel : Instruction break</h3>\n<p>L'instruction <code>break</code> permet de sortir imm√©diatement d'une boucle :</p>\n<pre><code class=\"language-cpp\">for (int i = 1; i <= 5; i++) {\n    if (i == 3) break;\n    std::cout << i << \" \";\n}</code></pre>",
        "course": "<p>Affichez les nombres jusqu'√† ce que la valeur atteigne 3, puis arr√™tez la boucle.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "for (int i = 1; i <= 5; i++) {",
          "if (i == 3) break;",
          "std::cout << i << \" \";",
          "}",
          "__PH3__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "for (int i = 1; i <= 5; i++) {",
          "if (i == 3) break;",
          "std::cout << i << \" \";",
          "}",
          "return 0;"
        ],
        "expectedOutput": "1 2 "
      }
    ]
  },
  {
    "id": "boucles",
    "name": "Boucles",
    "icon": "",
    "activities": [
      {
        "id": 1,
        "plan": "Boucle for simple",
        "description": "Afficher les nombres de 1 √† 5",
        "tutorial": "<h3> Tutoriel : Boucle for</h3>\n<p>La boucle <code>for</code> r√©p√®te un bloc de code un nombre d√©fini de fois :</p>\n<pre><code class=\"language-cpp\">for (int i = 1; i <= 5; i++) {\n    std::cout << i << std::endl;\n}</code></pre>",
        "course": "<p>Utilisez une boucle <code>for</code> pour afficher les nombres de 1 √† 5.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "for (int i = 1; i <= 5; i++) {",
          "std::cout << i << std::endl;",
          "}",
          "__PH3__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "for (int i = 1; i <= 5; i++) {",
          "std::cout << i << std::endl;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "1\n2\n3\n4\n5"
      },
      {
        "id": 2,
        "plan": "Boucle while",
        "description": "Compter de 0 √† 3",
        "tutorial": "<h3> Tutoriel : Boucle while</h3>\n<p>La boucle <code>while</code> r√©p√®te un bloc tant qu'une condition est vraie :</p>\n<pre><code class=\"language-cpp\">int compteur = 0;\nwhile (compteur <= 3) {\n    std::cout << compteur << std::endl;\n    compteur++;\n}</code></pre>",
        "course": "<p>Utilisez une boucle <code>while</code> pour compter de 0 √† 3.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "while (i <= 3) {",
          "std::cout << i << std::endl;",
          "i++;",
          "}",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int i = 0;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int i = 0;",
          "while (i <= 3) {",
          "std::cout << i << std::endl;",
          "i++;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "0\n1\n2\n3"
      },
      {
        "id": 3,
        "plan": "Boucle do-while",
        "description": "Ex√©cuter au moins une fois",
        "tutorial": "<h3> Tutoriel : Boucle do-while</h3>\n<p>La boucle <code>do-while</code> ex√©cute le bloc au moins une fois, puis teste la condition :</p>\n<pre><code class=\"language-cpp\">int i = 1;\ndo {\n    std::cout << i << \" \";\n    i++;\n} while (i <= 3);</code></pre>",
        "course": "<p>Affichez les nombres de 1 √† 3 avec une boucle <code>do-while</code>.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "do {",
          "std::cout << i << \" \";",
          "i++;",
          "} while (i <= 3);",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int i = 1;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int i = 1;",
          "do {",
          "std::cout << i << \" \";",
          "i++;",
          "} while (i <= 3);",
          "return 0;"
        ],
        "expectedOutput": "1 2 3 "
      },
      {
        "id": 4,
        "plan": "Boucle for avec break",
        "description": "Arr√™ter la boucle √† 3",
        "tutorial": "<h3> Tutoriel : Break dans boucle</h3>\n<p>La commande <code>break</code> arr√™te imm√©diatement une boucle :</p>\n<pre><code class=\"language-cpp\">for (int i = 1; i <= 5; i++) {\n    if (i == 3) break;\n    std::cout << i << \" \";\n}</code></pre>",
        "course": "<p>Affichez les nombres jusqu'√† 3 et arr√™tez la boucle.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "for (int i = 1; i <= 5; i++) {",
          "if (i == 3) break;",
          "std::cout << i << \" \";",
          "}",
          "__PH3__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "for (int i = 1; i <= 5; i++) {",
          "if (i == 3) break;",
          "std::cout << i << \" \";",
          "}",
          "return 0;"
        ],
        "expectedOutput": "1 2 "
      },
      {
        "id": 5,
        "plan": "Boucle for avec continue",
        "description": "Sauter le nombre 2",
        "tutorial": "<h3> Tutoriel : Continue dans boucle</h3>\n<p>La commande <code>continue</code> passe √† l'it√©ration suivante :</p>\n<pre><code class=\"language-cpp\">for (int i = 1; i <= 3; i++) {\n    if (i == 2) continue;\n    std::cout << i << \" \";\n}</code></pre>",
        "course": "<p>Affichez les nombres de 1 √† 3 en sautant 2.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "for (int i = 1; i <= 3; i++) {",
          "if (i == 2) continue;",
          "std::cout << i << \" \";",
          "}",
          "__PH3__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "for (int i = 1; i <= 3; i++) {",
          "if (i == 2) continue;",
          "std::cout << i << \" \";",
          "}",
          "return 0;"
        ],
        "expectedOutput": "1 3 "
      },
      {
        "id": 6,
        "plan": "Boucle imbriqu√©e",
        "description": "Afficher tableau multiplication 1 √† 3",
        "tutorial": "<h3> Tutoriel : Boucles imbriqu√©es</h3>\n<p>Une boucle peut √™tre plac√©e dans une autre :</p>\n<pre><code class=\"language-cpp\">for (int i = 1; i <= 3; i++) {\n    for (int j = 1; j <= 3; j++) {\n        std::cout << i*j << \" \";\n    }\n    std::cout << std::endl;\n}</code></pre>",
        "course": "<p>Affichez le tableau de multiplication de 1 √† 3.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "for (int i = 1; i <= 3; i++) {",
          "for (int j = 1; j <= 3; j++) {",
          "std::cout << i*j << \" \";",
          "}",
          "std::cout << std::endl;",
          "}",
          "__PH3__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "for (int i = 1; i <= 3; i++) {",
          "for (int j = 1; j <= 3; j++) {",
          "std::cout << i*j << \" \";",
          "}",
          "std::cout << std::endl;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "1 2 3 \n2 4 6 \n3 6 9 \n"
      },
      {
        "id": 7,
        "plan": "Boucle while avec break",
        "description": "Arr√™ter while √† 2",
        "tutorial": "<h3> Tutoriel : break dans while</h3>\n<p>Utilisez <code>break</code> pour sortir d'une boucle <code>while</code> :</p>\n<pre><code class=\"language-cpp\">int i = 1;\nwhile (i <= 3) {\n    if (i == 2) break;\n    std::cout << i << \" \";\n    i++;\n}</code></pre>",
        "course": "<p>Comptez jusqu'√† 3 mais arr√™tez √† 2.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "while (i <= 3) {",
          "if (i == 2) break;",
          "std::cout << i << \" \";",
          "i++;",
          "}",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int i = 1;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int i = 1;",
          "while (i <= 3) {",
          "if (i == 2) break;",
          "std::cout << i << \" \";",
          "i++;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "1 "
      },
      {
        "id": 8,
        "plan": "Boucle do-while avec continue",
        "description": "Sauter 2 dans do-while",
        "tutorial": "<h3> Tutoriel : continue dans do-while</h3>\n<p>La commande <code>continue</code> passe √† l'it√©ration suivante :</p>\n<pre><code class=\"language-cpp\">int i = 0;\ndo {\n    i++;\n    if (i == 2) continue;\n    std::cout << i << \" \";\n} while (i < 3);</code></pre>",
        "course": "<p>Affichez les nombres 1 et 3 avec <code>do-while</code> en sautant 2.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "do {",
          "i++;",
          "if (i == 2) continue;",
          "std::cout << i << \" \";",
          "} while (i < 3);",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int i = 0;",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int i = 0;",
          "do {",
          "i++;",
          "if (i == 2) continue;",
          "std::cout << i << \" \";",
          "} while (i < 3);",
          "return 0;"
        ],
        "expectedOutput": "1 3 "
      }
    ]
  },
  {
    "id": "tableaux_collections",
    "name": "Tableaux et collections",
    "icon": "",
    "activities": [
      {
        "id": 1,
        "plan": "Tableau simple",
        "description": "D√©clarer et afficher tableau",
        "tutorial": "<h3> Tutoriel : Tableaux en C++</h3>\n<p>Un tableau est une collection d'√©l√©ments du m√™me type, stock√©s de mani√®re contigu√´.</p>\n<p><strong>D√©claration :</strong></p>\n<pre><code class=\"language-cpp\">type nom[taille];\nint nombres[5];  // tableau de 5 entiers</code></pre>\n<p><strong>Initialisation :</strong></p>\n<pre><code class=\"language-cpp\">int nombres[5] = {10, 20, 30, 40, 50};</code></pre>\n<p><strong>Acc√®s aux √©l√©ments :</strong> Les indices commencent √† 0.</p>\n<pre><code class=\"language-cpp\">nombres[0]  // premier √©l√©ment (10)\nnombres[4]  // dernier √©l√©ment (50)</code></pre>",
        "course": "<p>D√©clarez un tableau et affichez ses √©l√©ments.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "std::cout << tab[0] << std::endl;",
          "std::cout << tab[1] << std::endl;",
          "std::cout << tab[2] << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int tab[3] = {1, 2, 3};",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int tab[3] = {1, 2, 3};",
          "std::cout << tab[0] << std::endl;",
          "std::cout << tab[1] << std::endl;",
          "std::cout << tab[2] << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "1\n2\n3"
      },
      {
        "id": 2,
        "plan": "Parcourir tableau",
        "description": "Boucle sur tableau",
        "tutorial": "<h3> Tutoriel : Parcourir un tableau</h3>\n<p>Utilisez une boucle <code>for</code> pour parcourir tous les √©l√©ments d'un tableau.</p>\n<pre><code class=\"language-cpp\">int tab[5] = {10, 20, 30, 40, 50};\nfor (int i = 0; i < 5; i++) {\n    std::cout << tab[i] << std::endl;\n}</code></pre>\n<p><strong>Boucle for moderne (C++11) :</strong></p>\n<pre><code class=\"language-cpp\">for (int valeur : tab) {\n    std::cout << valeur << std::endl;\n}</code></pre>",
        "course": "<p>Parcourez un tableau avec une boucle <code>for</code>.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "for (int i = 0; i < 4; i++) {",
          "std::cout << tab[i] << std::endl;",
          "}",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int tab[4] = {5, 10, 15, 20};",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int tab[4] = {5, 10, 15, 20};",
          "for (int i = 0; i < 4; i++) {",
          "std::cout << tab[i] << std::endl;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "5\n10\n15\n20"
      },
      {
        "id": 3,
        "plan": "Tableau de cha√Ænes",
        "description": "Stocker des noms",
        "tutorial": "<h3> Tutoriel : Tableaux de cha√Ænes</h3>\n<p>Vous pouvez stocker des cha√Ænes dans un tableau :</p>\n<pre><code class=\"language-cpp\">std::string noms[3] = {\"Alice\", \"Bob\", \"Charlie\"};\nfor (int i = 0; i < 3; i++) {\n    std::cout << noms[i] << std::endl;\n}</code></pre>",
        "course": "<p>D√©clarez un tableau de cha√Ænes et affichez chaque √©l√©ment.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "__PH4__",
          "for (int i = 0; i < 3; i++) {",
          "std::cout << noms[i] << std::endl;",
          "}",
          "__PH5__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {",
          "__PH4__": "std::string noms[3] = {\"Alice\", \"Bob\", \"Charlie\"};",
          "__PH5__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "int main() {",
          "std::string noms[3] = {\"Alice\", \"Bob\", \"Charlie\"};",
          "for (int i = 0; i < 3; i++) {",
          "std::cout << noms[i] << std::endl;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "Alice\nBob\nCharlie"
      },
      {
        "id": 4,
        "plan": "Modifier √©l√©ments",
        "description": "Changer valeurs tableau",
        "tutorial": "<h3> Tutoriel : Modifier un tableau</h3>\n<p>Vous pouvez modifier les √©l√©ments d'un tableau avec leur index :</p>\n<pre><code class=\"language-cpp\">int tab[3] = {1, 2, 3};\ntab[1] = 20;\nstd::cout << tab[1];  // affiche 20</code></pre>",
        "course": "<p>Changez la valeur d'un √©l√©ment du tableau et affichez-la.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "tab[1] = 20;",
          "std::cout << tab[1] << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int tab[3] = {1, 2, 3};",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int tab[3] = {1, 2, 3};",
          "tab[1] = 20;",
          "std::cout << tab[1] << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "20"
      },
      {
        "id": 5,
        "plan": "Tableau multidimensionnel",
        "description": "Matrice 2x2",
        "tutorial": "<h3> Tutoriel : Tableaux multidimensionnels</h3>\n<p>Un tableau 2D est comme une matrice :</p>\n<pre><code class=\"language-cpp\">int mat[2][2] = {{1,2},{3,4}};\nfor (int i = 0; i < 2; i++) {\n    for (int j = 0; j < 2; j++) {\n        std::cout << mat[i][j] << \" \";\n    }\n    std::cout << std::endl;\n}</code></pre>",
        "course": "<p>D√©clarez une matrice 2x2 et affichez-la.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "for (int i = 0; i < 2; i++) {",
          "for (int j = 0; j < 2; j++) {",
          "std::cout << mat[i][j] << \" \";",
          "}",
          "std::cout << std::endl;",
          "}",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int mat[2][2] = {{1,2},{3,4}};",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int mat[2][2] = {{1,2},{3,4}};",
          "for (int i = 0; i < 2; i++) {",
          "for (int j = 0; j < 2; j++) {",
          "std::cout << mat[i][j] << \" \";",
          "}",
          "std::cout << std::endl;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "1 2 \n3 4 \n"
      },
      {
        "id": 6,
        "plan": "Taille tableau",
        "description": "Trouver nombre d'√©l√©ments",
        "tutorial": "<h3> Tutoriel : Taille d'un tableau</h3>\n<p>Vous pouvez obtenir la taille d'un tableau en C++ :</p>\n<pre><code class=\"language-cpp\">int tab[5];\nint taille = sizeof(tab)/sizeof(tab[0]);\nstd::cout << taille;</code></pre>",
        "course": "<p>Affichez le nombre d'√©l√©ments d'un tableau.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "int taille = sizeof(tab)/sizeof(tab[0]);",
          "std::cout << taille << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int tab[5];",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int tab[5];",
          "int taille = sizeof(tab)/sizeof(tab[0]);",
          "std::cout << taille << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "5"
      },
      {
        "id": 7,
        "plan": "Tableau const",
        "description": "Tableau constant",
        "tutorial": "<h3> Tutoriel : Tableau constant</h3>\n<p>Vous pouvez d√©clarer un tableau constant qui ne peut pas √™tre modifi√© :</p>\n<pre><code class=\"language-cpp\">const int tab[3] = {1, 2, 3};\nstd::cout << tab[0];</code></pre>",
        "course": "<p>D√©clarez un tableau constant et affichez un √©l√©ment.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "std::cout << tab[0] << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "const int tab[3] = {1,2,3};",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "const int tab[3] = {1,2,3};",
          "std::cout << tab[0] << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "1"
      },
      {
        "id": 8,
        "plan": "Tableau et saisie utilisateur",
        "description": "Remplir tableau avec cin",
        "tutorial": "<h3> Tutoriel : Saisie dans un tableau</h3>\n<p>Vous pouvez remplir un tableau avec des valeurs entr√©es par l'utilisateur :</p>\n<pre><code class=\"language-cpp\">int tab[3];\nfor (int i = 0; i < 3; i++) {\n    std::cin >> tab[i];\n}\nfor (int i = 0; i < 3; i++) {\n    std::cout << tab[i] << std::endl;\n}</code></pre>",
        "course": "<p>Remplissez un tableau avec l'utilisateur et affichez-le.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "__PH3__",
          "for (int i = 0; i < 3; i++) {",
          "std::cin >> tab[i];",
          "}",
          "for (int i = 0; i < 3; i++) {",
          "std::cout << tab[i] << std::endl;",
          "}",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "int tab[3];",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "int main() {",
          "int tab[3];",
          "for (int i = 0; i < 3; i++) {",
          "std::cin >> tab[i];",
          "}",
          "for (int i = 0; i < 3; i++) {",
          "std::cout << tab[i] << std::endl;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "1\n2\n3"
      }
    ]
  },
  {
    "id": "structures",
    "name": "Les Structures",
    "icon": "",
    "activities": [
      {
        "id": 1,
        "plan": "Structure Point",
        "description": "Cr√©er struct Point",
        "tutorial": "<h3> Tutoriel : Les structures (struct)</h3>\n<p>Une structure permet de regrouper plusieurs variables de types diff√©rents sous un m√™me nom.</p>\n<p><strong>Exemple :</strong></p>\n<pre><code class=\"language-cpp\">struct Point {\n    int x;\n    int y;\n};\n\nPoint p;\np.x = 10;\np.y = 20;</code></pre>",
        "course": "<p>Cr√©ez une structure <code>Point</code> avec des coordonn√©es x et y.</p>",
        "solution": [
          "__PH1__",
          "struct Point {",
          "int x;",
          "int y;",
          "};",
          "__PH2__",
          "Point p;",
          "p.x = 5;",
          "p.y = 10;",
          "std::cout << p.x << \", \" << p.y << std::endl;",
          "__PH3__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "int main() {",
          "__PH3__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "struct Point {",
          "int x;",
          "int y;",
          "};",
          "int main() {",
          "Point p;",
          "p.x = 5;",
          "p.y = 10;",
          "std::cout << p.x << \", \" << p.y << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "5, 10"
      },
      {
        "id": 2,
        "plan": "Structure Personne",
        "description": "Struct nom et √¢ge",
        "tutorial": "<h3> Tutoriel : Structure avec diff√©rents types</h3>\n<p>Les structures peuvent contenir des membres de types diff√©rents.</p>\n<pre><code class=\"language-cpp\">struct Personne {\n    std::string nom;\n    int age;\n};\n\nPersonne p1;\np1.nom = \"Alice\";\np1.age = 25;\n\nstd::cout << p1.nom << \" a \" << p1.age << \" ans\";</code></pre>",
        "course": "<p>Cr√©ez une structure <code>Personne</code> avec un nom et un √¢ge.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "struct Personne {",
          "std::string nom;",
          "int age;",
          "};",
          "__PH3__",
          "Personne p = {\"Alice\", 25};",
          "std::cout << p.nom << \" : \" << p.age << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "struct Personne {",
          "std::string nom;",
          "int age;",
          "};",
          "int main() {",
          "Personne p = {\"Alice\", 25};",
          "std::cout << p.nom << \" : \" << p.age << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "Alice : 25"
      },
      {
        "id": 3,
        "plan": "Structure initialisation directe",
        "description": "Init struct avec valeurs",
        "tutorial": "<h3> Tutoriel : Initialisation directe</h3>\n<p>Vous pouvez initialiser directement une structure lors de sa d√©claration :</p>\n<pre><code class=\"language-cpp\">Personne p2 = {\"Bob\", 30};\nstd::cout << p2.nom << \" : \" << p2.age << std::endl;</code></pre>",
        "course": "<p>Initialisez une structure avec des valeurs directement.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "struct Personne { std::string nom; int age; };",
          "__PH3__",
          "Personne p2 = {\"Bob\", 30};",
          "std::cout << p2.nom << \" : \" << p2.age << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "struct Personne { std::string nom; int age; };",
          "int main() {",
          "Personne p2 = {\"Bob\", 30};",
          "std::cout << p2.nom << \" : \" << p2.age << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "Bob : 30"
      },
      {
        "id": 4,
        "plan": "Tableau de structures",
        "description": "Plusieurs personnes",
        "tutorial": "<h3> Tutoriel : Tableau de structures</h3>\n<p>Vous pouvez cr√©er un tableau de structures :</p>\n<pre><code class=\"language-cpp\">Personne tab[2] = {{\"Alice\",25}, {\"Bob\",30}};\nfor (int i = 0; i < 2; i++) {\n    std::cout << tab[i].nom << \" : \" << tab[i].age << std::endl;\n}</code></pre>",
        "course": "<p>Cr√©ez un tableau de structures et affichez-les.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "struct Personne { std::string nom; int age; };",
          "__PH3__",
          "Personne tab[2] = {{\"Alice\",25}, {\"Bob\",30}};",
          "for (int i = 0; i < 2; i++) {",
          "std::cout << tab[i].nom << \" : \" << tab[i].age << std::endl;",
          "}",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "struct Personne { std::string nom; int age; };",
          "int main() {",
          "Personne tab[2] = {{\"Alice\",25}, {\"Bob\",30}};",
          "for (int i = 0; i < 2; i++) {",
          "std::cout << tab[i].nom << \" : \" << tab[i].age << std::endl;",
          "}",
          "return 0;"
        ],
        "expectedOutput": "Alice : 25\nBob : 30"
      },
      {
        "id": 5,
        "plan": "Structure avec fonction",
        "description": "Fonction affichage structure",
        "tutorial": "<h3> Tutoriel : Fonctions et structures</h3>\n<p>Vous pouvez passer une structure √† une fonction :</p>\n<pre><code class=\"language-cpp\">void afficher(Personne p) {\n    std::cout << p.nom << \" : \" << p.age << std::endl;\n}\n\nPersonne p = {\"Alice\",25};\nafficher(p);</code></pre>",
        "course": "<p>Cr√©ez une fonction qui prend une structure et affiche ses membres.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "struct Personne { std::string nom; int age; };",
          "void afficher(Personne p) {",
          "std::cout << p.nom << \" : \" << p.age << std::endl;",
          "}",
          "__PH3__",
          "Personne p = {\"Alice\",25};",
          "afficher(p);",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "struct Personne { std::string nom; int age; };",
          "void afficher(Personne p) {",
          "std::cout << p.nom << \" : \" << p.age << std::endl;",
          "}",
          "int main() {",
          "Personne p = {\"Alice\",25};",
          "afficher(p);",
          "return 0;"
        ],
        "expectedOutput": "Alice : 25"
      },
      {
        "id": 6,
        "plan": "Structure avec pointeur",
        "description": "Acc√©der aux membres via pointeur",
        "tutorial": "<h3> Tutoriel : Pointeurs vers structures</h3>\n<p>Vous pouvez utiliser un pointeur pour acc√©der aux membres :</p>\n<pre><code class=\"language-cpp\">Personne p = {\"Bob\",30};\nPersonne* ptr = &p;\nstd::cout << ptr->nom << \" : \" << ptr->age << std::endl;</code></pre>",
        "course": "<p>Acc√©dez aux membres d'une structure via un pointeur.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "struct Personne { std::string nom; int age; };",
          "__PH3__",
          "Personne p = {\"Bob\",30};",
          "Personne* ptr = &p;",
          "std::cout << ptr->nom << \" : \" << ptr->age << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "struct Personne { std::string nom; int age; };",
          "int main() {",
          "Personne p = {\"Bob\",30};",
          "Personne* ptr = &p;",
          "std::cout << ptr->nom << \" : \" << ptr->age << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "Bob : 30"
      },
      {
        "id": 7,
        "plan": "Structure imbriqu√©e",
        "description": "Adresse dans Personne",
        "tutorial": "<h3> Tutoriel : Structure imbriqu√©e</h3>\n<p>Une structure peut contenir une autre structure :</p>\n<pre><code class=\"language-cpp\">struct Adresse {\n    std::string ville;\n    int codePostal;\n};\n\nstruct Personne {\n    std::string nom;\n    Adresse adr;\n};\n\nPersonne p = {\"Alice\", {\"Paris\",75000}};\nstd::cout << p.nom << \", \" << p.adr.ville << \", \" << p.adr.codePostal << std::endl;</code></pre>",
        "course": "<p>Cr√©ez une structure imbriqu√©e et affichez ses membres.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "struct Adresse { std::string ville; int codePostal; };",
          "struct Personne { std::string nom; Adresse adr; };",
          "__PH3__",
          "Personne p = {\"Alice\", {\"Paris\",75000}};",
          "std::cout << p.nom << \", \" << p.adr.ville << \", \" << p.adr.codePostal << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "struct Adresse { std::string ville; int codePostal; };",
          "struct Personne { std::string nom; Adresse adr; };",
          "int main() {",
          "Personne p = {\"Alice\", {\"Paris\",75000}};",
          "std::cout << p.nom << \", \" << p.adr.ville << \", \" << p.adr.codePostal << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "Alice, Paris, 75000"
      },
      {
        "id": 8,
        "plan": "Modifier structure via fonction",
        "description": "Changer √¢ge d'une personne",
        "tutorial": "<h3> Tutoriel : Passer structure par r√©f√©rence</h3>\n<p>Pour modifier une structure dans une fonction, utilisez une r√©f√©rence :</p>\n<pre><code class=\"language-cpp\">void changerAge(Personne &p, int age) {\n    p.age = age;\n}\n\nPersonne p = {\"Bob\",30};\nchangerAge(p, 35);\nstd::cout << p.nom << \" : \" << p.age << std::endl;</code></pre>",
        "course": "<p>Modifiez l'√¢ge d'une structure via une fonction.</p>",
        "solution": [
          "__PH1__",
          "__PH2__",
          "struct Personne { std::string nom; int age; };",
          "void changerAge(Personne &p, int age) {",
          "p.age = age;",
          "}",
          "__PH3__",
          "Personne p = {\"Bob\",30};",
          "changerAge(p,35);",
          "std::cout << p.nom << \" : \" << p.age << std::endl;",
          "__PH4__",
          "}"
        ],
        "placeholders": {
          "__PH1__": "#include <iostream>",
          "__PH2__": "#include <string>",
          "__PH3__": "int main() {",
          "__PH4__": "return 0;"
        },
        "pool": [
          "#include <iostream>",
          "#include <string>",
          "struct Personne { std::string nom; int age; };",
          "void changerAge(Personne &p, int age) {",
          "p.age = age;",
          "}",
          "int main() {",
          "Personne p = {\"Bob\",30};",
          "changerAge(p,35);",
          "std::cout << p.nom << \" : \" << p.age << std::endl;",
          "return 0;"
        ],
        "expectedOutput": "Bob : 35"
      }
    ]
  }
]

// === Monaco Editor Setup ===
let editor;

require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' }});

require(['vs/editor/editor.main'], function () {
  editor = monaco.editor.create(document.getElementById('monacoEditor'), {
    value: '// Compl√©tez le code en glissant les fragments dans les emplacements...\n',
    language: 'cpp',
    theme: 'vs-dark',
    automaticLayout: true,
    fontSize: 14,
    minimap: { enabled: false },
    scrollBeyondLastLine: false,
    wordWrap: 'on',
    suggestOnTriggerCharacters: true,
    quickSuggestions: true,
    parameterHints: { enabled: true },
    autoClosingBrackets: 'always',
    formatOnPaste: true,
    formatOnType: true,
    readOnly: false
  });
});

// === Variables globales ===
const categorySelect = document.getElementById("categorySelect");
const activitySelect = document.getElementById("activitySelect");

let currentCategory = categories[0];
let currentActivity = categories[0].activities[0];
let completedSlots = 0;
let totalSlots = 0;

// Remplir le s√©lecteur de cat√©gories
categories.forEach(cat => {
  const opt = document.createElement("option");
  opt.value = cat.id;
  opt.textContent = `${cat.icon} ${cat.name}`;
  categorySelect.appendChild(opt);
});

// === Notifications ===
function showNotification(type, title, message) {
  const notification = document.getElementById('notification');
  notification.className = `notification ${type}`;
  notification.innerHTML = `
    <h4>${title}</h4>
    <p style="color: var(--text-secondary); margin: 0;">${message}</p>
  `;
  notification.classList.add('show');
  
  setTimeout(() => {
    notification.classList.remove('show');
  }, 3000);
}

// === Mise √† jour de la progression ===
function updateProgress() {
  const percentage = totalSlots > 0 ? Math.round((completedSlots / totalSlots) * 100) : 0;
  const progressBar = document.getElementById('progressBar');
  const progressText = document.getElementById('progressText');
  
  progressBar.style.width = percentage + '%';
  progressBar.textContent = percentage + '%';
  
  if (percentage === 100) {
    progressText.innerHTML = '‚úÖ <strong>Exercice compl√©t√© !</strong> Vous pouvez maintenant ex√©cuter le code.';
    progressText.style.color = 'var(--success)';
    showNotification('success', 'üéâ F√©licitations !', 'Vous avez compl√©t√© l\'exercice avec succ√®s !');
    
    // Save completed activity
    saveActivityData(true);
  } else {
    progressText.innerHTML = `Compl√©tez tous les emplacements (${completedSlots}/${totalSlots})`;
    progressText.style.color = 'var(--text-secondary)';
  }
}

// === Charger les activit√©s d'une cat√©gorie ===
function loadCategoryActivities(categoryId) {
  if (!categoryId) return;
  
  const cat = categories.find(c => c.id === categoryId);
  if (!cat || !cat.activities || cat.activities.length === 0) return;
  
  currentCategory = cat;
  activitySelect.innerHTML = "";
   
  cat.activities.forEach(act => {
    const opt = document.createElement("option");
    opt.value = act.id;
    opt.textContent = `${act.id}. ${act.plan}`;
    activitySelect.appendChild(opt);
  });
  
  if (cat.activities.length > 0) {
    loadActivity(cat.activities[0].id);
  }
}

// === Charger une activit√© ===
function loadActivity(activityId) {
  const act = currentCategory.activities.find(a => a.id == activityId);
  if (!act) return;
  
  // Save previous activity data
  if (currentActivity) {
    saveActivityData();
  }
  
  currentActivity = act;
  document.getElementById("activityDesc").textContent = act.description;
  document.getElementById("activityCourse").innerHTML = act.course;
  document.getElementById("activityTutorial").innerHTML = act.tutorial;

  Prism.highlightAllUnder(document.getElementById("activityTutorial"));

  const pool = document.getElementById("pool");
  const solution = document.getElementById("solution");
  pool.innerHTML = "";
  solution.innerHTML = "";

  // Reset activity stats
  currentActivityStats = {
    correctAttempts: 0,
    errorAttempts: 0,
    timeSpent: 0
  };
  updateStatsDisplay();
  
  // Start activity timer
  stopActivityTimer();
  startActivityTimer();

  // Compter les placeholders
  totalSlots = Object.keys(act.placeholders).length;
  completedSlots = 0;
  updateProgress();

  const shuffledPool = [...act.pool].sort(() => Math.random() - 0.5);
  shuffledPool.forEach(fragment => {
    const div = document.createElement("div");
    div.textContent = fragment;
    div.className = "code-line";
    div.draggable = true;
    div.dataset.fragment = fragment;
    pool.appendChild(div);
  });

  act.solution.forEach(line => {
    const div = document.createElement("div");
    div.className = "code-line fixed";

    let html = escapeHtml(line);

    Object.keys(act.placeholders).forEach(ph => {
      const escapedPh = escapeHtml(ph);
      if (html.includes(escapedPh)) {
        html = html.replace(
          escapedPh,
          `<span class="drop-slot" data-ph="${ph}" data-expected="${escapeHtml(act.placeholders[ph])}">‚¨ö</span>`
        );
      }
    });

    div.innerHTML = html;
    solution.appendChild(div);
  });

  updateEditableCode();
}

categorySelect.addEventListener("change", e => loadCategoryActivities(e.target.value));
activitySelect.addEventListener("change", e => loadActivity(parseInt(e.target.value)));

// === Drag & Drop avec validation ===
let dragged = null;

document.addEventListener("dragstart", e => {
  if (e.target.classList.contains("code-line") && !e.target.classList.contains("fixed")) {
    dragged = e.target;
    e.target.classList.add("dragging");
  }
});

document.addEventListener("dragend", e => {
  if (e.target.classList.contains("dragging")) {
    e.target.classList.remove("dragging");
  }
  dragged = null;
});

document.addEventListener("dragover", e => {
  e.preventDefault();
});

document.addEventListener("drop", e => {
  e.preventDefault();
  
  if (dragged && e.target.classList.contains("drop-slot")) {
    const expectedValue = e.target.dataset.expected;
    const droppedValue = dragged.dataset.fragment;
    
    // V√©rification automatique
    if (droppedValue === expectedValue) {
      // Bonne r√©ponse
      e.target.textContent = droppedValue;
      e.target.classList.remove('error');
      e.target.classList.add('filled');
      e.target.style.animation = 'none';
      dragged.remove();
      
      completedSlots++;
      currentActivityStats.correctAttempts++;
      updateStatsDisplay();
      updateProgress();
      updateEditableCode();
      
      // Notification de succ√®s
      if (completedSlots < totalSlots) {
        showNotification('success', '‚úÖ Correct !', 'Fragment plac√© au bon endroit.');
      }
    } else {
      // Mauvaise r√©ponse
      e.target.classList.add('error');
      currentActivityStats.errorAttempts++;
      updateStatsDisplay();
      showNotification('error', '‚ùå Incorrect', 'Ce fragment ne va pas √† cet endroit. R√©essayez !');
      
      setTimeout(() => {
        e.target.classList.remove('error');
      }, 1000);
    }
    
    // Save activity progress
    saveActivityData();
  }
  
  dragged = null;
});

// === Mise √† jour de l'√©diteur ===
function updateEditableCode() {
  const solutionEl = document.getElementById("solution");
  let code = "";
  
  solutionEl.querySelectorAll(".code-line").forEach(line => {
    const lineText = Array.from(line.childNodes).map(node => {
      if (node.nodeType === Node.TEXT_NODE) {
        return node.textContent;
      } else if (node.nodeType === Node.ELEMENT_NODE) {
        if (node.classList.contains('drop-slot')) {
          return node.classList.contains('filled') ? node.textContent : '‚¨ö';
        }
        return node.textContent;
      }
      return '';
    }).join("");
    code += lineText + "\n";
  });
  
  if (editor) {
    editor.setValue(code);
  }
}

// === Copier vers compilateur ===
function copyToCompiler() {
  const code = editor ? editor.getValue() : '';
  
  if (!code || code.includes('‚¨ö')) {
    showNotification('error', '‚ö†Ô∏è Code incomplet', 'Veuillez compl√©ter tous les emplacements avant de copier le code.');
    return;
  }
  
  navigator.clipboard.writeText(code).then(() => {
    showNotification('success', 'üìã Code copi√© !', 'Le code a √©t√© copi√© dans votre presse-papier. Collez-le dans le compilateur ci-dessous.');
    
    // Scroll vers le compilateur
    document.querySelector('.compiler-section').scrollIntoView({ behavior: 'smooth' });
  }).catch(err => {
    showNotification('error', '‚ùå Erreur', 'Impossible de copier le code. Veuillez le copier manuellement.');
  });
}

// === R√©initialiser l'activit√© ===
function resetActivity() {
  if (confirm('√ätes-vous s√ªr de vouloir r√©initialiser l\'activit√© ?')) {
    // Save current stats before reset
    saveActivityData();
    
    loadActivity(currentActivity.id);
    showNotification('success', 'üîÑ R√©initialis√©', 'L\'activit√© a √©t√© r√©initialis√©e.');
  }
}

// === Utilitaires ===
function escapeHtml(text) {
  const map = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#039;'
  };
  return text.replace(/[&<>"']/g, m => map[m]);
}

// Initialize application
window.onload = function() {
  if (checkAuth()) {
    loadCategoryActivities(currentCategory.id);
  }
};
</script>
</body>
</html>